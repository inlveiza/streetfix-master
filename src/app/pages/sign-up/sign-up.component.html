<div class="signup-container">
    <div class="curved-background">
        <div class="logo-container">
            <div class="logo">
                <img src="assets/streetfix-logo.png" alt="StreetFix Logo">
            </div>
        </div>
    </div>

    <div class="form-card">
        <h2>{{ showOtpVerification ? 'Verify Email' : 'Sign up' }}</h2>
        <p class="subtitle">
            {{ showOtpVerification ? 'Enter the verification code sent to your email' : 'Create an account to start reporting issues.' }}
        </p>

        <!-- Sign Up Form -->
        <form *ngIf="!showOtpVerification" [formGroup]="signUpForm" (ngSubmit)="onSubmit()">
            <div class="form-group">
                <input type="text" 
                       formControlName="fullName" 
                       placeholder="Full Name"
                       class="form-input"
                       [class.error]="signUpForm.get('fullName')?.invalid && signUpForm.get('fullName')?.touched">
                <div class="error-message" *ngIf="signUpForm.get('fullName')?.invalid && signUpForm.get('fullName')?.touched">
                    {{ getErrorMessage('fullName') }}
                </div>
            </div>

            <div class="form-group">
                <input type="email" 
                       formControlName="email" 
                       placeholder="Email Address"
                       class="form-input"
                       [class.error]="signUpForm.get('email')?.invalid && signUpForm.get('email')?.touched">
                <div class="error-message" *ngIf="signUpForm.get('email')?.invalid && signUpForm.get('email')?.touched">
                    {{ getErrorMessage('email') }}
                </div>
            </div>

            <div class="form-group">
                <input type="text" 
                       formControlName="address" 
                       placeholder="Address"
                       class="form-input"
                       [class.error]="signUpForm.get('address')?.invalid && signUpForm.get('address')?.touched">
                <div class="error-message" *ngIf="signUpForm.get('address')?.invalid && signUpForm.get('address')?.touched">
                    {{ getErrorMessage('address') }}
                </div>
            </div>

            <div class="form-group">
                <div class="password-input-container">
                    <input [type]="showPassword ? 'text' : 'password'"
                           formControlName="password" 
                           placeholder="Password"
                           class="form-input"
                           [class.error]="signUpForm.get('password')?.invalid && signUpForm.get('password')?.touched">
                    <button type="button" class="toggle-password" (click)="togglePasswordVisibility('password')">
                        <i class="fas" [ngClass]="{'fa-eye': !showPassword, 'fa-eye-slash': showPassword}"></i>
                    </button>
                </div>
                <div class="error-message" *ngIf="signUpForm.get('password')?.invalid && signUpForm.get('password')?.touched">
                    {{ getErrorMessage('password') }}
                </div>
            </div>

            <div class="form-group">
                <div class="password-input-container">
                    <input [type]="showConfirmPassword ? 'text' : 'password'"
                           formControlName="confirmPassword" 
                           placeholder="Confirm Password"
                           class="form-input"
                           [class.error]="signUpForm.get('confirmPassword')?.invalid && signUpForm.get('confirmPassword')?.touched">
                    <button type="button" class="toggle-password" (click)="togglePasswordVisibility('confirmPassword')">
                        <i class="fas" [ngClass]="{'fa-eye': !showConfirmPassword, 'fa-eye-slash': showConfirmPassword}"></i>
                    </button>
                </div>
                <div class="error-message" *ngIf="signUpForm.get('confirmPassword')?.invalid && signUpForm.get('confirmPassword')?.touched">
                    {{ getErrorMessage('confirmPassword') }}
                </div>
            </div>

            <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
            <div class="success-message" *ngIf="successMessage">{{ successMessage }}</div>

            <button type="submit" class="signup-btn" [disabled]="!signUpForm.valid || isLoading">
                {{ isLoading ? 'Creating account...' : 'Create Account' }}
            </button>
        </form>

        <!-- OTP Verification Form -->
        <form *ngIf="showOtpVerification" [formGroup]="otpForm" (ngSubmit)="verifyOtp()">
            <div class="form-group">
                <input type="text" 
                       formControlName="otp" 
                       placeholder="Enter 6-digit code"
                       class="form-input otp-input"
                       maxlength="6"
                       [class.error]="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched">
                <div class="error-message" *ngIf="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched">
                    {{ getOtpErrorMessage() }}
                </div>
            </div>

            <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
            <div class="success-message" *ngIf="successMessage">{{ successMessage }}</div>

            <button type="submit" class="verify-btn" [disabled]="!otpForm.valid || isLoading">
                {{ isLoading ? 'Verifying...' : 'Verify Email' }}
            </button>
        </form>
    </div>

    <div class="signin-prompt">
        Already have an account? <a href="/sign-in" class="signin-link">Sign in here</a>
    </div>
</div>
